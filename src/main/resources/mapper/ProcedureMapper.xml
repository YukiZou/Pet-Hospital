<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ecnu.dao.ProcedureDao">

    <resultMap id="procedureResultMap" type="com.ecnu.entity.Procedure">
        <id  column="id" property="id" />
        <result column="role_id" property="roleId" />
        <result column="domain" property="domain" />
        <result column="step" property="step" />
        <result column="step_name" property="stepName" />
        <result column="info" property="info" />
    </resultMap>

    <insert id="insertProcedureStep" parameterType="com.ecnu.entity.Procedure" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO pet.procedure (role_id, domain, step, step_name, info)
        VALUES (#{roleId}, #{domain}, #{step}, #{stepName}, #{info})
    </insert>

    <select id="queryProcedureStep" parameterType="com.ecnu.entity.Procedure" resultMap="procedureResultMap">
        SELECT *
        FROM pet.procedure
        <where>
            <if test="id!=null and id>0">
                id=#{id}
            </if>
            <if test="roleId!=null and roleId>0">
                AND role_id=#{roleId}
            </if>
            <if test="domain!=null and domain!=''">
                AND domain LIKE CONCAT('%',#{domain},'%')
            </if>
            <if test="step!=null and step>0">
                AND step=#{step}
            </if>
            <if test="stepName!=null and stepName!=''">
                AND step_name LIKE CONCAT('%',#{stepName},'%')
            </if>
            <if test="info!=null and info!=''">
                AND info LIKE CONCAT('%',#{info},'%')
            </if>
        </where>
    </select>



</mapper>